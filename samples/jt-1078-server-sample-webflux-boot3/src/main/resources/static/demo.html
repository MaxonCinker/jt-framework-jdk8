<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>flv demo</title>
</head>
<body>
<div>
    <button onclick="play()">播放</button>
    <button onclick="pause()">暂停</button>
    <video id="videoElement" width="640" height="480" controls autoplay></video>
</div>
<script src="./mpegts.js"></script>
<script>
    let player
    function flv_load_mds() {
        const element = document.getElementById('videoElement');
        if (typeof player !== "undefined") {
            if (player != null) {
                player.unload();
                player.detachMediaElement();
                player.destroy();
                player = null;
            }
        }
        player = mpegts.createPlayer({
            isLive: true,
            type: 'flv',
            url: 'ws://localhost:8989/jt1078/subscription/flv/018930946552/3?timeout=10000',
            enableWorker: true,
            enableStashBuffer: false,
            stashInitialSize: 128    // 减少首桢显示等待时长
        });
        player.attachMediaElement(element);
        player.load();
    }
    function play() {
        player.play();
    }
    function pause() {
        player.pause();
    }
    document.addEventListener('DOMContentLoaded', function () {
        flv_load_mds();
    });
</script>
</body>
</html>
